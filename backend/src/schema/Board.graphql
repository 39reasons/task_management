type Board {
  id: ID!
  name: String!
  project_id: ID!
  team_id: ID!
  workflow_type: BoardWorkflowType!
  stages: [Stage!]!
}

type Stage {
  id: ID!
  name: String!
  position: Int!
  board_id: ID!
  tasks: [Task!]!
}

enum BoardWorkflowType {
  KANBAN
  SCRUM
  BUG_TRACKING
  CONTENT_PIPELINE
  CUSTOM
}

extend type Query {
  boards(project_id: ID!): [Board!]!
  board(id: ID!): Board
  boardWorkflowTypes: [BoardWorkflowType!]!
  stages(board_id: ID!): [Stage!]!
}

extend type Mutation {
  addStage(board_id: ID!, name: String!, position: Int): Stage!
  updateStage(id: ID!, name: String, position: Int): Stage!
  deleteStage(id: ID!): Boolean!
  reorderStages(board_id: ID!, stage_ids: [ID!]!): Boolean!
  generateBoardStages(input: GenerateBoardStagesInput!): [Stage!]!
  updateBoard(id: ID!, name: String, workflow_type: BoardWorkflowType): Board!
}

input GenerateBoardStagesInput {
  board_id: ID!
  prompt: String!
}

enum TaskBoardEventAction {
  TASK_CREATED
  TASK_UPDATED
  TASK_DELETED
  TASK_MOVED
  TASKS_REORDERED
  STAGE_CREATED
  STAGE_UPDATED
  STAGE_DELETED
  STAGES_REORDERED
}

type TaskBoardEvent {
  action: TaskBoardEventAction!
  project_id: ID!
  team_id: ID
  board_id: ID
  stage_id: ID
  previous_stage_id: ID
  task_id: ID
  task_ids: [ID!]
  stage_ids: [ID!]
  origin: String
  timestamp: String
}

extend type Subscription {
  taskBoardEvents(project_id: ID!): TaskBoardEvent!
}
